{% extends 'basic.html' %}
{% block title %}{{title}}{% endblock title %}
{% block css %}{% endblock css %}
{% block main %}
{% load static %}

<main class="main-content">
  <h2 class="header">Registration</h2>
  <div class="progress align-items-center">
    <div class="numbering" style="background-color: #09864b;">1</div>
    <div class="progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100"></div>

    <div class="numbering">2</div>
    <div class="progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100"></div>

    <div class="numbering">3</div>
    <div class="progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100"></div>

    <div class="numbering">4</div>
    <div class="progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100"></div>

    <div class="numbering">5</div>
    <div class="progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100"></div>
    <div class="numbering">6</div>
    <div class="progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100"></div>
    <div class="numbering"><i class="fa-duotone fa-check"></i></div>
  </div>
  <div class="register">
    <div id="registrationForm">
      {% if messages %}
      {% for message in messages %}
      <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
        <strong>{{ message }}</strong>
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      {% endfor %}
      {% endif %}

      {% if messages %}
      <ul class="messages">
        {% for message in messages %}
        <li{% if message.tags %} class="{{ message.tags }}" {% endif %}>{{ message }}</li>
          {% endfor %}

          {% endif %}
          http://127.0.0.1:8000/registration/
          <form action="#" method="post">{% csrf_token %}
            <!-- Section 1 -->
            <div class="page section1" id="form1">
              <h3>Step 1: Select Membership Category</h3>

              <input class="form-check-input" type="radio" name="Membership" id="flexRadioDefault2" value="RS. 1000 FEE INDIVIDUAL"
                checked>
              <label class="form-check-label" for="flexRadioDefault2">
                Individual (INDIA) - <strong>â‚¹1,000.00</strong>
                <span class="text-danger"> *</span></label>
              <div class="mt-3">
                <button type="button" class="btn btn-success forward">Next</button>
              </div>
            </div>

            <!-- Section 2 -->
            <div class="page section2" id="form2">
              <h3>Step 2: Personal Details </h3>
              <!-- Add your contact information fields here -->
              <div class="form-group mt-3">
                <label for="name">Enter Your Full Name<span class="text-danger"> *</span></label><br>
                <span class="d-flex mt-2" style="column-gap: 10px;">
                  <select class="form-control" name="Select-Status" id="status" style="width: 15%;">
                    <option value="" disabled selected>- Select -</option>
                    <option value="Mr.">Mr.</option>
                    <option value="Mr.">Mrs.</option>
                    <option value="Mr.">Miss.</option>
                    <option value="Mr.">Dr.</option>
                    <option value="Mr.">Shri.</option>
                    <option value="Mr.">Prof.</option>
                  </select>
                  <input type="text" name="Name" id="name" class="form-control" placeholder="Enter Name Here"
                    style="width: 85%;" required>
                </span>
              </div>
              <div class="form-group mt-3">
                <label for="gender" class="mb-2">Select Your Gender<span class="text-danger"> *</span></label>
                <select class="form-control" id="gender" name="Gender" required>
                  <option value="" disabled selected>Select Gender</option>
                  <option value="male">Male</option>
                  <option value="female">Female</option>
                  <option value="other">Other</option>
                </select>
              </div>

              <div class="form-group mt-3">
                <label for="dob" class="mb-2">Date of Birth:<span class="text-danger"> *</span></label>
                <input type="date" class="form-control" id="dob" name="DOB" required>
              </div>

              <div class="form-group mt-3">
                <label for="areaOfInterest" class="mb-2">Select Area of Interest<span class="text-danger">
                    *</span></label>
                <select id="areaOfInterest" class="form-control" name="Area-Of-Interest" required>
                  <option value="" disabled selected>- Select-</option>
                  <option value="Traditional Knowledge and Applications">Traditional Knowledge and Applications
                  </option>
                  <option value="Environment">Environment</option>
                  <option value="Energy">Energy</option>
                  <option value="Health Sciences">Health Sciences</option>
                  <option value="Engineering Sciences">Engineering Sciences</option>
                  <option value="Literature">Literature</option>
                  <option value="Infrastructure, Technology and Communications">Infrastructure, Technology and
                    Communications</option>
                  <option value="Waste Management">Waste Management</option>
                  <option value="Woman Empowerment">Woman Empowerment</option>
                  <option value="School Student Activities">School Student Activities</option>
                  <option value="Agriculture and Veterinary Science">Agriculture and Veterinary Science</option>
                  <option value="Indic Science">Indic Science</option>
                  <option value="Other">Other</option>

                </select>
              </div>
              <div id="otherInput">

                <div class="form-group mt-3">
                  <label for="otherInput">Other: <span class="text-danger"> *</span></label>
                  <input type="text" class="form-control" name="Other-Interest" placeholder="Example, Arts and Crafts">
                </div>
              </div>

              <div class="form-group mt-3">
                <label for="instituteName mb-2">Enter Name of Affiliated Institute<span class="text-danger">
                    *</span></label>
                <input type="text" id="instituteName" name="Institute-Name" class="form-control"
                  placeholder="Example, BBAU UNIVERSITY" required>
              </div>

              <div class="form-group mt-3">
                <label for="designation mb-2">Enter Your Designation<span class="text-danger"> *</span></label>
                <input type="text" name="Designation" class="form-control" placeholder="Enter Designation" required>
              </div>

              <div class="form-buttons mt-3">
                <button type="button" class="btn btn-primary prevBtn">Previous</button>
                <button type="button" class="btn btn-primary forward">Next</button>
              </div>

            </div>

            <!-- Section 3 -->
            <div class="page section3" id="form3">
              <h3>Step 3: Contact Details</h3>

              <div class="form-group mt-3">
                <label for="pri-email mb-2">Enter Your Primary Email Address<span class="text-danger"> *</span></label>
                <input type="text" name="Primary-Email" class="form-control" placeholder="Enter Primary Email" required>
              </div>

              <div class="form-group mt-3">
                <label for="pri-mobile mb-2">Enter Your Primary Mobile Number<span class="text-danger"> *</span></label>
                <input type="text" name="Primary-Mobile" class="form-control" placeholder="Enter Primary Mobile NUmber"
                  required>
              </div>

              <div class="form-group mt-3">
                <label for="pri-whatsapp mb-2">Enter Your Primary Whatsapp Number<span class="text-danger">
                    *</span></label>
                <input type="text" name="Primary-WhatsApp" class="form-control"
                  placeholder="Enter Primary Whatsapp NUmber" required>
              </div>

              <div class="form-group mt-3">

                <label for="password mb-2">Password:<span class="text-danger"> *</span></label>
                <input class="form-control" type="password" id="password" name="Pass1" placeholder="enter Password"
                  required>
                <p id="passwordRules" class="mt-2" style="color: red;"></p>

              </div>

              <div class="form-group mt-3">
                <label for="cnrfpassword mb-2">Confirm Password:<span class="text-danger"> *</span></label>
                <input type="password" class="form-control" id="cnrfpassword" name="Pass2"
                  placeholder="enter Password again" required>
                <p id="cnfrmPasswordInputTextContent" class="mt-2" style="color: red;"></p>

              </div>

              <div class="form-buttons mt-3">
                <button type="button" class="btn btn-primary prevBtn">Previous</button>
                <button type="button" class="btn btn-primary forward">Next</button>
              </div>


            </div>

            <!-- Section 4 -->
            <div class="page section4" id="form4">
              <h3>Step 4: Enter Your Regional Details</h3>

              <div class="form-group mt-3">

                <label for="countrySelect" class="mb-2">Select Country:<span class="text-danger"> *</span></label><br>
                <select class="form-control" id="countrySelect" name="Country" required>
                  <option value="" disabled selected>-- Select Country --</option>
                  <option value="India">India</option>

                </select>
              </div>

              <div class="form-group mt-3">
                <label for="stateSelect" class="mb-2">Select State:<span class="text-danger"> *</span></label><br>
                <select class="form-control" id="stateSelect" name="State" onchange="populateCities()">
                  <option value="">-- Select State --</option>
                  <option value="andhra_pradesh">Andhra Pradesh</option>
                  <option value="maharashtra">Maharashtra</option>
                  <option value="tamil_nadu">Tamil Nadu</option>
                  <!-- Add more states here -->
                </select>

              </div>

              <div class="form-group mt-3">
                <label for="citySelect" class="mb-2">Select City:<span class="text-danger"> *</span></label><br>
                <select class="form-control" name="City" id="citySelect">
                  <option value="">-- Select City --</option>
                </select>
              </div>

              <div class="form-group mt-3">
                <label for="pinCode mb-2">Enter Pin/Zip Code<span class="text-danger"> *</span></label>
                <input type="text" id="pinCode" class="form-control" name="Pin-Code" placeholder="Example, 411011"
                  required>
              </div>

              <div class="form-group mt-3">
                <label for="postAddress mb-2">Enter Postal Address<span class="text-danger"> *</span></label><br>
                <!-- <input type="text" id="postAddress" class="form-control" placeholder="Enter postal address" required> -->
                <textarea class="form-control mt-2" name="Postal-Address" id="postAddress" cols="50" rows="4"></textarea>
              </div>

              <div class="form-buttons mt-3">
                <button type="button" class="btn btn-primary prevBtn">Previous</button>
                <button type="button" class="btn btn-primary forward preview">View Preview</button>
              </div>
            </div>

            <div class="previewForm" style="display: none;">
              <h3>Step 5: Confirm your Profile Details:</h3>
              <div class="container">
                <table class="table table-hover table-bordered">
                  <tbody>
                    
                  </tbody>
                </table>

                <div class="form-group">
                  <div class="form-check">
                    <input class="form-check-input" name="Accept-Terms" type="checkbox" id="gridCheck" value="Accepted" checked>
                    <label class="form-check-label" for="gridCheck">
                      I accept all <a href="">terms and conditions</a>related to VIBHA registration.
                    </label>
                  </div>
                </div>

              </div>

            </div>

          </form>
    </div>
  </div>
</main>

{% endblock main %}

{% block js %}
<script>

  var area = document.querySelector('.register');
  var numbering = document.querySelectorAll('.progress .numbering');
  var progressBar = document.querySelectorAll('.progress .progress-bar')
  var count = 1

  area.addEventListener('click', function (e) {
    // console.log(e.target)
    if (e.target.classList.contains('forward')) {
      let targeted = e.target.parentElement.parentElement
      const inputs = document.querySelectorAll('#' + targeted.id + ' [name]');
      let isEmpty = false;
      // console.log(inputs)
      for (let j = 0; j < inputs.length; j++) {
        const input = inputs[j];
        if (input.value.trim() === '') {
          isEmpty = true;
          input.style.borderColor = 'red'; // Optional: Highlight empty fields
        } else {
          input.style.borderColor = ''; // Optional: Reset border color
        }

      }
        if (isEmpty) {
          alert('Please fill in all the required fields.');
        }
        else {

          numbering[count].classList.add('next-numbering');
          progressBar[count].classList.add('next-progress-bar')

          e.target.parentElement.parentElement.style.display = 'none';
          e.target.parentElement.parentElement.nextElementSibling.style.display = 'block';
          count += 1
        }



      
      if (e.target.classList.contains('prevBtn')) {
        count -= 1
        progressBar[count].classList.remove('next-progress-bar')
        numbering[count].classList.remove('next-numbering');
        e.target.parentElement.parentElement.style.display = 'none';
        e.target.parentElement.parentElement.previousElementSibling.style.display = 'block';
      }
    }
  })


    var previewInputs = document.querySelector('.previewForm table tbody')
    document.querySelector('#registrationForm form .preview').addEventListener('click', getValue)
    function getValue() {
      var allInputs = document.querySelectorAll('#registrationForm .page [name]')
      var insertHtml = ''
      for (let i = 0; i < allInputs.length; i++) {
        let name = (allInputs[i].name);
        let val = allInputs[i].value;
        console.log("name of attribut == ",name,"value == ",val)
        if (name == "Pass1" || name == "Pass2" || name == "csrfmiddlewaretoken") {
          continue;
        }
        insertHtml += '<tr><th scope="row">' + name + '</th><td>' + val + '</td></tr>'
        console.log("yes")
        
      }
      confirm("All information is fill coorectly?")
      previewInputs.innerHTML = insertHtml
    }



    const selectField = document.getElementById('areaOfInterest');
    // const otherInputContainer = document.getElementById('interest-others');
    const otherInput = document.getElementById('otherInput');

    selectField.addEventListener('change', function () {
      if (selectField.value === 'Other') {
        otherInput.style.display = 'block'
        otherInput.innerHTML = '<div class="form-group mt-3"><label for="other2">Other: <span class="text-danger"> *</span></label><input type="text" class="form-control" id="other2" name="Other-Interest" placeholder="Example, Arts and Crafts"></div>'
      } else {
        otherInput.style.display = 'none';
        otherInput.innerHTML = ''
        otherInput.value = ''; // Clear the input if not 'other'
      }
    });


    const citiesByState = {
      andhra_pradesh: ["Hyderabad", "Visakhapatnam", "Vijayawada", "Guntur"],
      maharashtra: ["Mumbai", "Pune", "Nagpur", "Nashik"],
      tamil_nadu: ["Chennai", "Coimbatore", "Madurai", "Salem"],
      // Add more states and their cities here
    };


    function handlePrevBtn(prvSection) {
      console.log("in function ...", prvSection);
      prvSection.style.display = 'block'
      console.log("out function ...", prvSection);


    }
    function populateCities() {
      const stateSelect = document.getElementById("stateSelect");
      const citySelect = document.getElementById("citySelect");
      const selectedState = stateSelect.value;
      const cities = citiesByState[selectedState] || [];

      // Clear existing city options
      citySelect.innerHTML = '<option value="">-- Select City --</option>';

      // Add city options for the selected state
      cities.forEach((city) => {
        const option = document.createElement("option");
        option.value = city;
        option.textContent = city;
        citySelect.appendChild(option);
      });
    }

    // Trigger initial population of cities when the page loads
    populateCities();


    var passwordInput = document.querySelector('form #password');
    var cnfrmPasswordInput = document.querySelector('form #cnrfpassword');
    var passwordRulesElement = document.querySelector('form #passwordRules');
    var cnfrmPasswordInputTextContent = document.querySelector('form #cnfrmPasswordInputTextContent')
    // console.log("####",passwordInput,passwordRulesElement)

    passwordInput.addEventListener('input', checkPasswordRules);

    function checkPasswordRules() {
      const password = passwordInput.value;
      const rules = [];

      // Check minimum length
      if (password.length < 8) {
        rules.push('Minimum length: 8 characters');
      }

      // Check complexity
      if (!/[A-Z]/.test(password)) {
        rules.push('Include at least one uppercase letter');
      }
      if (!/[a-z]/.test(password)) {
        rules.push('Include at least one lowercase letter');
      }
      if (!/\d/.test(password)) {
        rules.push('Include at least one number');
      }
      if (!/[\W_]/.test(password)) {
        rules.push('Include at least one special character');
      }

      // Check common passwords
      const commonPasswords = ['password', '123456', 'qwerty', 'abc123']; // Add more if needed
      if (commonPasswords.includes(password.toLowerCase())) {
        rules.push('Choose a stronger password');
      }

      // Check username in password
      const username = 'exampleUser'; // Replace with the actual username or fetch from the server
      if (password.toLowerCase().includes(username.toLowerCase())) {
        rules.push('Avoid using your username in the password');
      }

      // Check for dictionary words or easily guessable information
      const dictionaryWords = ['example', 'password', 'user']; // Add more if needed
      if (dictionaryWords.some(word => password.toLowerCase().includes(word))) {
        rules.push('Avoid using dictionary words or easily guessable information');
      }

      // Display password rules
      if (rules.length === 0) {
        passwordRulesElement.textContent = 'Password is strong!';
      } else {
        passwordRulesElement.textContent = rules.join('\n');
      }
    }

    cnfrmPasswordInput.addEventListener('keyup', () => {

      if ((passwordInput.value) != (cnfrmPasswordInput.value)) {

        cnfrmPasswordInputTextContent.textContent = "password does not match";

      }
      else {

        cnfrmPasswordInputTextContent.textContent = "";
      }



    })

</script>
{% endblock js %}